// ============================================================
// Inventory Count Client Action — SCSS
// ============================================================

$brand:       #4B35D4;
$brand-lt:    #EBE8FC;
$brand2:      #7B63F5;
$success:     #059669;
$success-lt:  #D1FAE5;
$warn:        #D97706;
$warn-lt:     #FEF3C7;
$danger:      #DC2626;
$danger-lt:   #FEE2E2;
$ink:         #16142E;
$muted:       #7A778F;
$muted2:      #AEABC4;
$line:        #E2E0EF;
$bg:          #F0EFF8;

.o_ica_root {
    display: flex;
    flex-direction: column;
    height: 100%;
    background: $bg;
    font-family: 'IBM Plex Sans', -apple-system, sans-serif;
    -webkit-font-smoothing: antialiased;
}

// Loading
.o_ica_loading {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: $muted;
}

// ── Header ──────────────────────────────────────────────────

.o_ica_header {
    background: #16142E;
    padding: 12px 16px 0;
    flex-shrink: 0;
}

.o_ica_header_top {
    display: flex;
    align-items: center;
    margin-bottom: 12px;

    .o_ica_title {
        color: white;
        font-size: 18px;
        font-weight: 700;
        flex: 1;
    }

    .o_ica_validate_btn {
        background: $success;
        color: white;
        border: none;
        border-radius: 9px;
        padding: 8px 14px;
        font-size: 13px;
        font-weight: 700;
        cursor: pointer;
        transition: background .15s;

        i { margin-right: 5px; }
        &:hover { background: darken($success, 8%); }
    }
}

.o_ica_prog_row {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;

    .o_ica_prog_bar {
        flex: 1;
        height: 4px;
        background: rgba(255,255,255,.12);
        border-radius: 99px;
        overflow: hidden;

        .o_ica_prog_fill {
            height: 100%;
            background: linear-gradient(90deg, $brand2, #A78BFA);
            border-radius: 99px;
            transition: width .6s ease;
        }
    }

    .o_ica_prog_label {
        color: rgba(255,255,255,.5);
        font-size: 12px;
        white-space: nowrap;
        b { color: rgba(255,255,255,.9); }
    }
}

.o_ica_search_row {
    margin-bottom: 8px;

    .o_ica_search_wrap {
        position: relative;

        .o_ica_search_icon {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255,255,255,.4);
            font-size: 13px;
        }

        .o_ica_search_input {
            width: 100%;
            background: rgba(255,255,255,.1);
            border: 1.5px solid rgba(255,255,255,.12);
            border-radius: 9px;
            padding: 8px 12px 8px 32px;
            color: white;
            font-size: 13px;
            outline: none;
            transition: border-color .15s;

            &::placeholder { color: rgba(255,255,255,.35); }
            &:focus { border-color: $brand2; }
        }
    }
}

.o_ica_tabs {
    display: flex;
    gap: 4px;
    padding-bottom: 0;
    overflow-x: auto;
    &::-webkit-scrollbar { display: none; }

    .o_ica_tab {
        padding: 6px 12px;
        border-radius: 9px 9px 0 0;
        border: none;
        background: rgba(255,255,255,.08);
        color: rgba(255,255,255,.5);
        font-size: 12px;
        font-weight: 600;
        cursor: pointer;
        white-space: nowrap;
        transition: all .15s;
        margin-bottom: 0;

        &.active {
            background: $bg;
            color: $brand;
        }

        &:hover:not(.active) { background: rgba(255,255,255,.14); color: white; }
    }
}

// ── Column headers ───────────────────────────────────────────

.o_ica_col_headers {
    display: grid;
    grid-template-columns: 1fr 1fr;
    padding: 10px 14px 4px;
    gap: 10px;
    background: $bg;
    flex-shrink: 0;

    .o_ica_col_hdr {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 11px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: .5px;
        color: $muted;

        &.done { color: $success; }

        .o_ica_hdr_dot {
            width: 7px; height: 7px;
            border-radius: 50%;
            background: $muted2;
            flex-shrink: 0;
            &.done { background: $success; }
        }

        .o_ica_hdr_count {
            margin-left: auto;
            background: $line;
            color: $muted;
            font-size: 10px;
            padding: 1px 7px;
            border-radius: 99px;
            &.done { background: $success-lt; color: $success; }
        }
    }
}

// ── Board ────────────────────────────────────────────────────

.o_ica_board {
    display: grid;
    grid-template-columns: 1fr 1fr;
    flex: 1;
    overflow: hidden;
    padding: 0 10px;
    gap: 0;

    .o_ica_col {
        display: flex;
        flex-direction: column;
        gap: 8px;
        overflow-y: auto;
        padding: 4px 4px 80px;
        &::-webkit-scrollbar { display: none; }
    }
}

.o_ica_empty_col {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 30px 10px;
    color: $muted2;
    font-size: 12px;
    text-align: center;
    gap: 8px;
}

// ── Kanban card ──────────────────────────────────────────────

.o_ica_kcard {
    background: white;
    border-radius: 14px;
    box-shadow: 0 2px 8px rgba(22,20,46,.08), 0 0 1px rgba(22,20,46,.04);
    overflow: hidden;
    cursor: pointer;
    transition: box-shadow .15s, transform .15s;
    animation: ica_card_in .28s cubic-bezier(.4,0,.2,1) both;

    @keyframes ica_card_in {
        from { opacity: 0; transform: translateY(10px) scale(.96); }
        to   { opacity: 1; transform: none; }
    }

    &:hover { box-shadow: 0 6px 20px rgba(22,20,46,.12); }
    &.done  { background: #F0FDF6; }
    &.active { box-shadow: 0 0 0 2px $brand, 0 6px 20px rgba(22,20,46,.1); }

    .o_ica_stripe {
        height: 3px;
        &.stripe-pending { background: $line; }
        &.stripe-match   { background: $success; }
        &.stripe-over    { background: $danger; }
        &.stripe-short   { background: $warn; }
    }

    .o_ica_kcard_body { padding: 10px 11px 10px; }

    .o_ica_kcat {
        font-size: 9px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: .6px;
        color: $brand;
        margin-bottom: 3px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .o_ica_kname {
        font-size: 12px;
        font-weight: 700;
        color: $ink;
        line-height: 1.25;
        margin-bottom: 4px;
    }

    .o_ica_kloc {
        font-size: 10px;
        color: $muted2;
        margin-bottom: 7px;
        i { margin-right: 3px; }
    }

    .o_ica_exp_row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: $bg;
        border-radius: 7px;
        padding: 4px 7px;
        margin-bottom: 7px;

        .o_ica_exp_lbl { font-size: 9px; color: $muted2; }
        .o_ica_exp_val { font-family: monospace; font-size: 11px; font-weight: 700; color: $ink; }
        .o_ica_uom { color: $muted2; font-size: 9px; }
    }

    .o_ica_count_field {
        width: 100%;
        background: $bg;
        border: 1.5px solid $line;
        border-radius: 8px;
        padding: 6px 9px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        cursor: pointer;
        transition: border-color .15s, background .15s;

        &:hover   { border-color: $muted2; }
        &.focused { border-color: $brand; box-shadow: 0 0 0 3px rgba($brand,.1); }
        &.is-counted { background: $success-lt; border-color: transparent; }

        .o_ica_cf_val      { font-family: monospace; font-size: 13px; font-weight: 700; color: $success; }
        .o_ica_cf_placeholder { font-size: 11px; color: $muted2; }
        i { font-size: 12px; color: $muted2; }
    }

    .o_ica_status_row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-top: 6px;
    }

    .o_ica_chip {
        display: inline-flex; align-items: center; gap: 4px;
        font-size: 10px; font-weight: 700;
        padding: 2px 7px; border-radius: 99px;

        .o_ica_dot { width: 5px; height: 5px; border-radius: 50%; }

        &.chip-pending { background: $line; color: $muted; .o_ica_dot { background: $muted2; } }
        &.chip-match   { background: $success-lt; color: $success; .o_ica_dot { background: $success; } }
        &.chip-over    { background: $danger-lt; color: $danger; .o_ica_dot { background: $danger; } }
        &.chip-short   { background: $warn-lt; color: $warn; .o_ica_dot { background: $warn; } }
    }

    .o_ica_match_btn {
        font-size: 10px; font-weight: 700; color: $success;
        background: $success-lt; border: none; border-radius: 6px;
        padding: 3px 8px; cursor: pointer;
        &:hover { background: darken($success-lt, 5%); }
    }
}

// ── Backdrop ─────────────────────────────────────────────────

.o_ica_backdrop {
    position: fixed; inset: 0;
    background: rgba(22,20,46,.4);
    z-index: 1040;
}

// ── Numpad Drawer ────────────────────────────────────────────

.o_ica_drawer {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    background: white;
    border-radius: 22px 22px 0 0;
    box-shadow: 0 -4px 40px rgba(22,20,46,.2);
    z-index: 1050;
    transform: translateY(100%);
    transition: transform .32s cubic-bezier(.4,0,.2,1);
    max-width: 560px;
    margin: 0 auto;

    &.open { transform: translateY(0); }

    .o_ica_drawer_handle {
        display: flex; justify-content: center; padding: 12px 0 4px;
        .o_ica_handle_bar { width: 36px; height: 4px; background: $line; border-radius: 99px; }
    }

    .o_ica_drawer_product {
        padding: 4px 18px 12px;
        border-bottom: 1px solid $line;
        display: flex; align-items: flex-start; justify-content: space-between; gap: 10px;

        .o_ica_dp_name { font-size: 16px; font-weight: 700; color: $ink; line-height: 1.2; }
        .o_ica_dp_loc  { font-size: 12px; color: $muted2; margin-top: 2px; }
    }

    .o_ica_drawer_close {
        width: 28px; height: 28px; border-radius: 8px;
        background: $bg; border: none; cursor: pointer;
        color: $muted; font-size: 14px;
        display: flex; align-items: center; justify-content: center;
        &:hover { background: $line; }
    }

    .o_ica_dd_wrap {
        padding: 10px 18px 8px;
        display: flex; align-items: flex-end; gap: 12px;

        .o_ica_dd_main { flex: 1; }

        .o_ica_dd_label {
            font-size: 10px; font-weight: 700; text-transform: uppercase;
            letter-spacing: .5px; color: $muted2; margin-bottom: 4px;
        }

        .o_ica_dd_val {
            font-family: 'Courier New', monospace;
            font-size: 38px; font-weight: 700; color: $ink; line-height: 1;
            display: flex; align-items: center;

            &.empty { color: $muted2; font-size: 22px; font-family: inherit; font-weight: 400; }
            .o_ica_dd_unit { font-size: 14px; color: $muted2; margin-left: 4px; font-family: inherit; font-weight: 400; }

            .o_ica_cursor {
                display: inline-block; width: 3px; height: 32px;
                background: $brand; border-radius: 2px; margin-left: 4px;
                animation: ica_blink .7s ease infinite;
                @keyframes ica_blink { 0%,100%{opacity:1} 50%{opacity:0} }
            }
        }

        .o_ica_dd_side { display: flex; flex-direction: column; align-items: flex-end; gap: 5px; padding-bottom: 4px; }

        .o_ica_dd_exp {
            text-align: right;
            .o_ica_dd_exp_lbl { font-size: 9px; color: $muted2; font-weight: 600; text-transform: uppercase; }
            .o_ica_dd_exp_val { font-family: monospace; font-size: 13px; font-weight: 600; color: $ink; }
        }

        .o_ica_dd_diff {
            background: $bg; border-radius: 7px; padding: 4px 9px; text-align: right;
            .o_ica_dd_diff_lbl { font-size: 9px; color: $muted2; font-weight: 600; text-transform: uppercase; }
            .o_ica_dd_diff_val {
                font-family: monospace; font-size: 14px; font-weight: 700; margin-top: 1px;
                &.pos  { color: $warn; }
                &.neg  { color: $danger; }
                &.zero { color: $success; }
                &.none { color: $muted2; }
            }
        }
    }

    .o_ica_qs_row {
        display: flex; gap: 6px; padding: 4px 18px 8px; flex-wrap: wrap;

        .o_ica_qs {
            padding: 5px 12px; border-radius: 8px; border: 1.5px solid $line;
            background: white; font-family: monospace; font-size: 12px; font-weight: 600;
            color: $ink; cursor: pointer; transition: all .12s;

            &:hover { border-color: $brand; color: $brand; }
            &:active { transform: scale(.92); }

            &.match { background: $success-lt; color: $success; border-color: transparent; font-family: inherit; }
            &.clear { color: $muted; font-family: inherit; }
        }
    }

    .o_ica_numpad {
        display: grid; grid-template-columns: repeat(3, 1fr);
        gap: 7px; padding: 6px 16px 8px;

        .o_ica_nk {
            height: 54px; border-radius: 12px; background: $bg; border: none;
            font-family: 'Courier New', monospace; font-size: 22px; font-weight: 600;
            color: $ink; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: background .1s, transform .08s;
            box-shadow: 0 1px 3px rgba(22,20,46,.06);

            &:active { transform: scale(.88); background: $line; }
            &.nk-dot { font-size: 28px; color: $muted; }
            &.nk-del { color: $muted; font-size: 16px; }
        }
    }

    .o_ica_drawer_acts {
        display: grid; grid-template-columns: 1fr 2.5fr;
        gap: 8px; padding: 4px 16px 28px;

        .o_ica_skip_btn {
            height: 50px; border-radius: 13px; border: 2px solid $line;
            background: white; font-size: 13px; font-weight: 700; color: $muted;
            cursor: pointer; transition: all .15s;
            i { margin-right: 4px; }
            &:hover { border-color: $muted; color: $ink; }
        }

        .o_ica_confirm_btn {
            height: 50px; border-radius: 13px; border: none;
            background: linear-gradient(135deg, $brand, $brand2);
            color: white; font-size: 15px; font-weight: 700;
            cursor: pointer; box-shadow: 0 4px 20px rgba($brand,.35);
            transition: all .15s;
            i { margin-right: 6px; }
            &:hover { box-shadow: 0 6px 28px rgba($brand,.5); }
            &:active { transform: scale(.96); }
            &.disabled { background: $line; color: $muted2; box-shadow: none; cursor: not-allowed; }
        }
    }
}
