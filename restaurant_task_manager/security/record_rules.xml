<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">

        <!-- Staff: own task lists only -->
        <record id="rule_task_list_staff" model="ir.rule">
            <field name="name">Task List: Staff sees own</field>
            <field name="model_id" ref="model_restaurant_task_list"/>
            <field name="domain_force">[('employee_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_task_staff'))]"/>
        </record>

        <!-- Manager: sees task lists at their work location(s) -->
        <record id="rule_task_list_manager" model="ir.rule">
            <field name="name">Task List: Manager sees own location</field>
            <field name="model_id" ref="model_restaurant_task_list"/>
            <field name="domain_force">[('location_id', 'in', user.employee_ids.work_location_id.ids)]</field>
            <field name="groups" eval="[(4, ref('group_task_manager'))]"/>
        </record>

        <!-- Admin: sees everything -->
        <record id="rule_task_list_admin" model="ir.rule">
            <field name="name">Task List: Admin sees all</field>
            <field name="model_id" ref="model_restaurant_task_list"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_task_admin'))]"/>
        </record>

        <!-- Staff: own task items only -->
        <record id="rule_task_item_staff" model="ir.rule">
            <field name="name">Task Item: Staff sees own</field>
            <field name="model_id" ref="model_restaurant_task_item"/>
            <field name="domain_force">[('employee_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_task_staff'))]"/>
        </record>

        <record id="rule_task_item_manager" model="ir.rule">
            <field name="name">Task Item: Manager sees own location</field>
            <field name="model_id" ref="model_restaurant_task_item"/>
            <field name="domain_force">[('location_id', 'in', user.employee_ids.work_location_id.ids)]</field>
            <field name="groups" eval="[(4, ref('group_task_manager'))]"/>
        </record>

        <!-- Staff: own subtasks only -->
        <record id="rule_subtask_staff" model="ir.rule">
            <field name="name">Subtask: Staff sees own</field>
            <field name="model_id" ref="model_restaurant_task_subtask"/>
            <field name="domain_force">[('employee_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_task_staff'))]"/>
        </record>

        <record id="rule_subtask_manager" model="ir.rule">
            <field name="name">Subtask: Manager sees own location</field>
            <field name="model_id" ref="model_restaurant_task_subtask"/>
            <field name="domain_force">[('task_item_id.location_id', 'in', user.employee_ids.work_location_id.ids)]</field>
            <field name="groups" eval="[(4, ref('group_task_manager'))]"/>
        </record>

        <!-- Quick Task: Staff sees own assigned -->
        <record id="rule_quick_task_staff" model="ir.rule">
            <field name="name">Quick Task: Staff sees own</field>
            <field name="model_id" ref="model_restaurant_quick_task"/>
            <field name="domain_force">[('employee_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_task_staff'))]"/>
        </record>

        <record id="rule_quick_task_manager" model="ir.rule">
            <field name="name">Quick Task: Manager sees own location</field>
            <field name="model_id" ref="model_restaurant_quick_task"/>
            <field name="domain_force">[('location_id', 'in', user.employee_ids.work_location_id.ids)]</field>
            <field name="groups" eval="[(4, ref('group_task_manager'))]"/>
        </record>

    </data>
</odoo>
